<xml xmlns="https://developers.google.com/blockly/xml"><variables><variable id="uvs38)?zxEp[O^tiKluB">ADCaddress</variable><variable id=".Ov}/L%}c/rhxch.BnO,">CONFIG</variable><variable id="I}+)4jyoDt@XB@E;CqXN">buf</variable><variable id="g:%DTB/rS{;MUF07perj">configValue</variable><variable id="YODQc_uvgRMB4{H#akK8">busy</variable><variable id="$Z,;MnB?yxQ)GjT{%weH">temp</variable><variable id="hO}sK?dwe?a9/hdY-!5s">result</variable><variable id="rOzOibMfg9)T84el;6~C">CONVERSION</variable><variable id="8r%}6LOzq|y#T1-E*kbx">OS</variable><variable id="Q{mfA4Td+!PoVI(9J}ca">MUX</variable><variable id="5huF]wv;:%[QOu?1ogvt">PGA</variable><variable id=":wO1pO2lE%:QAu!I4fY[">MODE</variable><variable id="/9vsRVab$Yww$%Z1yvz(">DIS</variable></variables><block type="pxt-on-start" id="lNd{4`MKs3Hnb]E,oF(o" x="0" y="0"><statement name="HANDLER"><block type="variables_set" id="m9qXB$[Iffk)wD*6}-$X"><field name="VAR" id="rOzOibMfg9)T84el;6~C">CONVERSION</field><value name="VALUE"><shadow type="math_number" id="HM[!!DAO{6{?.?csfqJA"><field name="NUM">0</field></shadow></value><next><block type="typescript_statement" id="^SFe+b~}HFQvv[]*)%(h" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let ADCaddress = 0" numlines="1" declaredvars="ADCaddress"></mutation><next><block type="typescript_statement" id="oJsj9e?[O.`swMW5PNAd" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let configValue = 0" numlines="1" declaredvars="configValue"></mutation><next><block type="variables_set" id=",z%,ao,24;s,MQk,]]|-"><field name="VAR" id="uvs38)?zxEp[O^tiKluB">ADCaddress</field><comment pinned="false" h="80" w="160">slave address 0b1001000</comment><value name="VALUE"><shadow type="math_number" id="IIFJM]8w35[oQKL~]+-y"><field name="NUM">72</field></shadow></value><next><block type="variables_set" id=".dh$VQ*6|(8U?e7WEPZI"><field name="VAR" id=".Ov}/L%}c/rhxch.BnO,">CONFIG</field><comment pinned="false" h="80" w="160">Register 0
Register 1</comment><value name="VALUE"><shadow type="math_number" id="!,y%@#(]GT#Ru$D[xXxy"><field name="NUM">1</field></shadow></value><next><block type="variables_set" id="LtMUiti8TIa6DE$/Y{fV"><field name="VAR" id="8r%}6LOzq|y#T1-E*kbx">OS</field><comment pinned="false" h="80" w="160">Bit field OS set to 1 starts conversion</comment><value name="VALUE"><shadow type="math_number" id="w_JZDG]@*}9V6$jln+y["><field name="NUM">1</field></shadow></value><next><block type="variables_set" id="MsmMWwRaPSh.S~r$EVhv"><field name="VAR" id="Q{mfA4Td+!PoVI(9J}ca">MUX</field><comment pinned="false" h="80" w="160">Bit field MUX sets the ADC input channel: 100 = AIN0 single-ended</comment><value name="VALUE"><shadow type="math_number" id="$?n0yShIN^PcdJ]D~6=|"><field name="NUM">4</field></shadow></value><next><block type="variables_set" id="CZ*K6=J#*,(7c%3./KqO"><field name="VAR" id="5huF]wv;:%[QOu?1ogvt">PGA</field><comment pinned="false" h="80" w="160">Bit field: Gain = +/- 2.048V</comment><value name="VALUE"><shadow type="math_number" id="ekqju_x6g3TmAs/Ij8MN"><field name="NUM">2</field></shadow></value><next><block type="variables_set" id="@KUmfGt@h[Sod*3)iWmz"><field name="VAR" id=":wO1pO2lE%:QAu!I4fY[">MODE</field><comment pinned="false" h="80" w="160">Bit field: Mode = single shot</comment><value name="VALUE"><shadow type="math_number" id=")[NouAZR!*yuO=:!mXCF"><field name="NUM">1</field></shadow></value><next><block type="variables_set" id="|*aJ$302?~,@jZ!KHswZ"><field name="VAR" id="/9vsRVab$Yww$%Z1yvz(">DIS</field><comment pinned="false" h="80" w="160">Bit field DIS = 3 disables comparator</comment><value name="VALUE"><shadow type="math_number" id="/HXN.TFFT(3~.ldclVe$"><field name="NUM">3</field></shadow></value><next><block type="variables_set" id="fZ7`g6m2Ls=OLmqC%19]"><field name="VAR" id="g:%DTB/rS{;MUF07perj">configValue</field><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="bitwise_2arg" id="G3Z1hE?ke.2[x]PZR4MB"><field name="fn">operator.leftShift</field><value name="a"><block type="variables_get" id="uAWo{|)M*H;e$@]lrUo_"><field name="VAR" id="8r%}6LOzq|y#T1-E*kbx">OS</field></block></value><value name="b"><shadow type="math_number" id="NFDaLK4z~B-M1S^!OUl*"><field name="NUM">15</field></shadow></value></block></value><next><block type="variables_set" id="OcLO#VfIYj,Of#crPX{e"><field name="VAR" id="g:%DTB/rS{;MUF07perj">configValue</field><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="bitwise_2arg" id="kY4j6tj^3el*2JgLT,Or"><field name="fn">operator.or</field><value name="a"><block type="variables_get" id="BF:s_LJB#SHfP5HCT-)B"><field name="VAR" id="g:%DTB/rS{;MUF07perj">configValue</field></block></value><value name="b"><block type="bitwise_2arg" id="+?C;}aS7a;1NxFu`m3Hj"><field name="fn">operator.leftShift</field><value name="a"><block type="variables_get" id="O1Opp}^O2!/__UgJ{zm6"><field name="VAR" id="Q{mfA4Td+!PoVI(9J}ca">MUX</field></block></value><value name="b"><shadow type="math_number" id="cpTZLn%+)_y,/c,NuWK5"><field name="NUM">12</field></shadow></value></block></value></block></value><next><block type="variables_set" id="|[W!y;`5nGgP8s}?OHoV"><field name="VAR" id="g:%DTB/rS{;MUF07perj">configValue</field><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="bitwise_2arg" id=":6uSZ4jXMp~gXQhr4!eD"><field name="fn">operator.or</field><value name="a"><block type="variables_get" id="QQ1Q,Nk`nKx4r0-BQsjr"><field name="VAR" id="g:%DTB/rS{;MUF07perj">configValue</field></block></value><value name="b"><block type="bitwise_2arg" id="fu^ipCUB.Y+Y[mR]#-.l"><field name="fn">operator.leftShift</field><value name="a"><block type="variables_get" id="/0?^1QcJbd`sfXn_CzSx"><field name="VAR" id="5huF]wv;:%[QOu?1ogvt">PGA</field></block></value><value name="b"><shadow type="math_number" id="_HzMi*iY1z!H(BTwI!.T"><field name="NUM">9</field></shadow></value></block></value></block></value><next><block type="variables_set" id="-Az=Mw^dZHB~=#6oEe+u"><field name="VAR" id="g:%DTB/rS{;MUF07perj">configValue</field><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="bitwise_2arg" id="@.K6lR2[@B{~48,vU|on"><field name="fn">operator.or</field><value name="a"><block type="variables_get" id="6,fUY~XsL#$/x*wF%MD*"><field name="VAR" id="g:%DTB/rS{;MUF07perj">configValue</field></block></value><value name="b"><block type="bitwise_2arg" id="mA2hN2e}TkI(Fb9_V2cq"><field name="fn">operator.leftShift</field><value name="a"><block type="variables_get" id="V~s(HeGVSDEYtd_7H~nm"><field name="VAR" id=":wO1pO2lE%:QAu!I4fY[">MODE</field></block></value><value name="b"><shadow type="math_number" id="C2.m0B5f.(=%78{BliNe"><field name="NUM">8</field></shadow></value></block></value></block></value><next><block type="variables_set" id="#l$0=@YejPMj0h??H;jZ"><field name="VAR" id="g:%DTB/rS{;MUF07perj">configValue</field><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="bitwise_2arg" id="e8mA;[|FXbbn]@9z79]k"><field name="fn">operator.or</field><value name="a"><block type="variables_get" id="E@0f#K[amLb,shf#Lh=!"><field name="VAR" id="g:%DTB/rS{;MUF07perj">configValue</field></block></value><value name="b"><block type="bitwise_2arg" id="Ce]SQ6[Ba7]_AR+(cXp#"><field name="fn">operator.leftShift</field><value name="a"><block type="variables_get" id="/3Sv7J![1O~e9_^c:,TT"><field name="VAR" id="/9vsRVab$Yww$%Z1yvz(">DIS</field></block></value><value name="b"><shadow type="math_number" id="b8D2lOlwkKCq,lF9OAPY"><field name="NUM">0</field></shadow></value></block></value></block></value></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block><block type="function_definition" id="{?+l1^4QUf#eGrn5A:C@" x="1629" y="-66"><mutation name="startConversion" functionid="Rj*vm^H|XnzqlQyqc8{e"><arg name="num" id="g764s8imqz3402vd6yvq" type="number"></arg></mutation><field name="function_name">startConversion</field><comment pinned="false" h="80" w="160">Send:
* 1 byte to set Pointer to CONFIG address (01)
* then 2 bytes of configValue
serial.writeLine("ADCaddress =" + ADCaddress)
serial.writeLine("CONFIG = " + CONFIG)
serial.writeLine("ConfigValue = " + configValue)
// Write CONFIG reg address
pins.i2cWriteNumber(
ADCaddress,
CONFIG,
NumberFormat.Int8LE,
true
)
// Write num to CONFIG reg
pins.i2cWriteNumber(
ADCaddress,
configValue,
NumberFormat.UInt16BE,
false
)</comment><value name="g764s8imqz3402vd6yvq"><shadow type="argument_reporter_number" id="h~gvGwtuO?g3f?SU]l`0"><field name="VALUE">num</field></shadow></value><statement name="STACK"><block type="i2c_writenumber" id="Ri/3.[bsrRA37[!Wgr1/"><field name="format">NumberFormat.UInt8BE</field><value name="address"><block type="variables_get" id=",ZV]IkTAW#eg1dYX%3_]"><field name="VAR" id="uvs38)?zxEp[O^tiKluB">ADCaddress</field></block></value><value name="value"><block type="variables_get" id=",S%$nWVUf7B#AAkhd[3r"><field name="VAR" id=".Ov}/L%}c/rhxch.BnO,">CONFIG</field></block></value><next><block type="typescript_statement" id="*.KJ*7xeOBqYtZ:^vyQe" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let buf = pins.createBuffer(2);" numlines="1" declaredvars="buf"></mutation><next><block type="lists_index_set" id="7rp:iyfFq1|`PXXfR6gj"><value name="LIST"><block type="variables_get" id="lI?CiqL8OzH7]yp^(wyg"><field name="VAR" id="I}+)4jyoDt@XB@E;CqXN">buf</field></block></value><value name="INDEX"><shadow type="math_number" id="n-4-BrHBJ0WwezXj?l`v"><field name="NUM">0</field></shadow></value><value name="VALUE"><block type="typescript_expression" id="C|u%xiZV{8G@BFh-8wVt" editable="false"><field name="EXPRESSION">configValue &amp; 0xff</field></block></value><next><block type="lists_index_set" id="@0*!{/_=M~?r%f9@:k{6"><value name="LIST"><block type="variables_get" id="f+fY?09-o6=@%aF^~laq"><field name="VAR" id="I}+)4jyoDt@XB@E;CqXN">buf</field></block></value><value name="INDEX"><shadow type="math_number" id="l,)Lr(ww/7REAFIs`LhO"><field name="NUM">1</field></shadow></value><value name="VALUE"><block type="typescript_expression" id="UB!VpJ-iSb(+!ooynC{W" editable="false"><field name="EXPRESSION">configValue &gt;&gt; 8</field></block></value><next><block type="typescript_statement" id="B!;([d!5X9*:0p!s`^Dx" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="pins.i2cWriteBuffer(ADCaddress, buf);" numlines="1"></mutation></block></next></block></next></block></next></block></next></block></statement></block><block type="every_interval" id="`n2lPzDXs[A)4*C90|Kg" x="830" y="-11"><value name="interval"><shadow type="longTimePicker" id=")`zgtQo3H8WDmon#`y5X"><field name="ms">10000</field></shadow></value><statement name="HANDLER"><block type="serial_writeline" id="}+g{t[hUB?Z^XwjDf%p="><value name="text"><block type="text_join" id="^Z.#ryXXkhi=?]]yy,g3"><mutation items="2"></mutation><value name="ADD0"><shadow type="text" id="Jfwa)!8OR(XxgWX=y:.6"><field name="TEXT">configValue = </field></shadow></value><value name="ADD1"><shadow type="text"><field name="TEXT"></field></shadow><block type="variables_get" id="[{B{bWruo|aAH[6z@TM6"><field name="VAR" id="g:%DTB/rS{;MUF07perj">configValue</field></block></value></block></value><next><block type="function_call" id=",fP.lWoR+Iatcz]OTbB3"><mutation name="startConversion" functionid="Rj*vm^H|XnzqlQyqc8{e"><arg name="num" id="g764s8imqz3402vd6yvq" type="number"></arg></mutation><comment pinned="false" h="80" w="160">Start ADC conversion (OS =&gt; 1)</comment><value name="g764s8imqz3402vd6yvq"><shadow type="math_number"><field name="NUM">1</field></shadow><block type="variables_get" id="t-H5v=V/~zY/ojR])RkU"><field name="VAR" id="g:%DTB/rS{;MUF07perj">configValue</field></block></value><next><block type="serial_writeline" id="{cV9)NvP$j$N8JsHe7$+"><value name="text"><block type="text_join" id="3(ov:o(5.fdL%Kk}{XlW"><mutation items="2"></mutation><value name="ADD0"><shadow type="text" id="3^5#zx.ysov`X*#%I|)0"><field name="TEXT">ReadConfigValue = </field></shadow></value><value name="ADD1"><shadow type="text"><field name="TEXT"></field></shadow><block type="function_call_output" id="CD#4a[.;-}*Eij9|YJ4-"><mutation name="read" functionid="wGwmO6;+BfYy_JYyLHjy"></mutation></block></value></block></value><next><block type="variables_set" id="wee18=rV*I|q)BY`042."><field name="VAR" id="YODQc_uvgRMB4{H#akK8">busy</field><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="logic_boolean" id="EQuK]5p|LNrt2}1|0fj:"><field name="BOOL">TRUE</field></block></value><next><block type="device_while" id="AiDcOL1o31dveX~H_DUO"><comment pinned="false" h="80" w="160">Read status until conversion done</comment><value name="COND"><shadow type="logic_boolean"><field name="BOOL">TRUE</field></shadow><block type="variables_get" id="f`Z3FC)9i*Ng?gdVq]-I"><field name="VAR" id="YODQc_uvgRMB4{H#akK8">busy</field></block></value><statement name="DO"><block type="variables_set" id="`9{cd;p:$FyUjy{]B{wf"><field name="VAR" id="$Z,;MnB?yxQ)GjT{%weH">temp</field><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="function_call_output" id="CV9J*-?/u?AzSs(rssB{"><mutation name="read" functionid="wGwmO6;+BfYy_JYyLHjy"></mutation></block></value><next><block type="variables_set" id="#ln5~;s-j=,^{Ajo8?eU"><field name="VAR" id="YODQc_uvgRMB4{H#akK8">busy</field><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="logic_compare" id="k-_F51}q(_#zT6Vp08*a"><field name="OP">EQ</field><value name="A"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="bitwise_2arg" id="tFBMF!lrq:O$-ij*r@lV"><field name="fn">operator.rightShift</field><value name="a"><block type="variables_get" id="4b3HcVMyIvaOYN.h?GZi"><field name="VAR" id="$Z,;MnB?yxQ)GjT{%weH">temp</field></block></value><value name="b"><shadow type="math_number" id="{%w*L,XwD{v9Wwo%S-h9"><field name="NUM">15</field></shadow></value></block></value><value name="B"><shadow type="math_number" id="5Mcdpd#J$QQf8JgABijK"><field name="NUM">0</field></shadow></value></block></value><next><block type="serial_writeline" id="ZK]K`)L9Gxy-0t-_}ooA"><value name="text"><block type="text_join" id="ZoWY99ygm9u.j!nt1umk"><mutation items="2"></mutation><value name="ADD0"><shadow type="text" id="{SYF:/ufTx^EcW8Nl5#%"><field name="TEXT">Read config = </field></shadow></value><value name="ADD1"><shadow type="text"><field name="TEXT"></field></shadow><block type="variables_get" id="b!|VvNDC]-y4ZLNf7qoX"><field name="VAR" id="$Z,;MnB?yxQ)GjT{%weH">temp</field></block></value></block></value></block></next></block></next></block></statement><next><block type="function_call" id=",W#+7CP;ZheT1wpU/1-P"><mutation name="setPointer" functionid="3ru-;UlBDouz,k|S;ks`"><arg name="num" id="qftcfruqwgfr5ogzso8xf" type="number"></arg></mutation><comment pinned="false" h="80" w="160">Set pointer to read result</comment><value name="qftcfruqwgfr5ogzso8xf"><shadow type="math_number" id=")PiF[[]{cGsOj-rD1sDB"><field name="NUM">0</field></shadow></value><next><block type="variables_set" id="d@o:gRCy6V3r(5x.5mLq"><field name="VAR" id="hO}sK?dwe?a9/hdY-!5s">result</field><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="function_call_output" id=",n-q(,IIplb6R[FUI,/H"><mutation name="read" functionid="wGwmO6;+BfYy_JYyLHjy"></mutation></block></value><next><block type="serial_writeline" id=")*4rL=4mI,h0?bD,$gGx"><value name="text"><block type="text_join" id="m}L6WD;l~FAMNf-F_S=Y"><mutation items="2"></mutation><value name="ADD0"><shadow type="text" id="?w73W|bO(%WrMlSa9XNq"><field name="TEXT">Read data = </field></shadow></value><value name="ADD1"><shadow type="text"><field name="TEXT"></field></shadow><block type="variables_get" id="2=}(_z,[a48wL;6iA]6/"><field name="VAR" id="hO}sK?dwe?a9/hdY-!5s">result</field></block></value></block></value><next><block type="variables_set" id="qNV7vL+!}6QHFb4]=DY?"><field name="VAR" id="hO}sK?dwe?a9/hdY-!5s">result</field><comment pinned="false" h="80" w="160">Show top 8 bits</comment><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="bitwise_2arg" id="S]+5v:L=+XU/cRI:CS)."><field name="fn">operator.and</field><value name="a"><block type="variables_get" id="Lu|AXek!sM6]q,E`QH{Y"><field name="VAR" id="hO}sK?dwe?a9/hdY-!5s">result</field></block></value><value name="b"><shadow type="math_number" id="[Q1wFuA`CR/{btyYo*zM"><field name="NUM">65280</field></shadow></value></block></value><next><block type="variables_set" id="%9-Hp2MfqJIC`y[Q!oqt"><field name="VAR" id="hO}sK?dwe?a9/hdY-!5s">result</field><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="bitwise_2arg" id="(nKbFlKo#pU):LSH~tby"><field name="fn">operator.rightShift</field><value name="a"><block type="variables_get" id="2(taH/__iO2r;|1N@^C="><field name="VAR" id="hO}sK?dwe?a9/hdY-!5s">result</field></block></value><value name="b"><shadow type="math_number" id="yRovB)nL#@}c(I7`OoKv"><field name="NUM">8</field></shadow></value></block></value><next><block type="device_show_number" id="6~yx@xfAeF:*7%s~/lDI"><value name="number"><block type="variables_get" id="jX-o!XlH%Wa2Fh/w4L{S"><field name="VAR" id="hO}sK?dwe?a9/hdY-!5s">result</field></block></value></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block><block type="function_definition" id="k42Yl8]J_YWaYpqsYkSg" x="2344" y="-69"><mutation name="setPointer" functionid="3ru-;UlBDouz,k|S;ks`"><arg name="num" id="qftcfruqwgfr5ogzso8xf" type="number"></arg></mutation><field name="function_name">setPointer</field><value name="qftcfruqwgfr5ogzso8xf"><shadow type="argument_reporter_number" id="01Q9k2ZmNO3j8!gvu9wt"><field name="VALUE">num</field></shadow></value><statement name="STACK"><block type="i2c_writenumber" id="Mqm%BSuFy4Za=H:8o,+*"><field name="format">NumberFormat.Int8LE</field><value name="address"><block type="variables_get" id="ub(@5,}YFWnK;?nutNL#"><field name="VAR" id="uvs38)?zxEp[O^tiKluB">ADCaddress</field></block></value><value name="value"><block type="argument_reporter_number" id="Lzz4`BUsId3J:19Yk8ka"><field name="VALUE">num</field></block></value><value name="repeat"><shadow type="logic_boolean" id="K!]A|VbEqd2(w#xjx5(y"><field name="BOOL">FALSE</field></shadow></value></block></statement></block><block type="function_definition" id="c7lBMH_h9EY$HGyN^fU3" x="1440" y="708"><mutation name="read" functionid="wGwmO6;+BfYy_JYyLHjy"></mutation><field name="function_name">read</field><comment pinned="false" h="80" w="160">Read 2 bytes from either CONVERSION (Pointer = 0) or CONFIG (Pointer = 1)</comment><statement name="STACK"><block type="function_return" id="+:S/f)U}PDtxuSSy-]4I"><mutation xmlns="http://www.w3.org/1999/xhtml" no_return_value="false"></mutation><value name="RETURN_VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="pins_i2c_readnumber" id="oylZK:gPEv2c?n:^7vb,"><field name="format">NumberFormat.UInt16BE</field><value name="address"><block type="variables_get" id="[PTgp-+0VI%`L{f5?~f+"><field name="VAR" id="uvs38)?zxEp[O^tiKluB">ADCaddress</field></block></value><value name="repeat"><shadow type="logic_boolean" id="Zw{UpijqEQnVT)!,7)}z"><field name="BOOL">FALSE</field></shadow></value></block></value></block></statement></block></xml>